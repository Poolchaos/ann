<template>
  <div class="bordered--5 white container">
    <h1 class="black-text flex flex--justify-center">
      <img src="../../../assets/images/zanet-logo.png" />
      <div class="spacer-v--10"></div>
      <span>Articles</span>
    </h1>
    <div class="pull-right">
      <button class="blue" if.bind="dataStore.isJournalist" click.trigger="goToCreateArticle()">Create New Article</button>
      <button class="gray" if.bind="!dataStore.isJournalist" click.trigger="goToDashboard()">Back</button>
    </div>

    <div class="articles white-bg">

      <div repeat.for="article of articles" class="item" class.bind="article.selected ? 'is-selected' : ''">
        <div class="col">
          <img src.bind="'../../../assets/images/icon-' + article.category + '.png'" width="50px" height="50px" />
        </div>
        <div class="col">
          <div><h5 class="black-text">Name: ${article.name}</h5></div>
          <div innerhtml.bind="article.content"></div>
          <div>
            Files: ${article.files.length === 0 ? '0 files' : ''}
            <div repeat.for="file of article.files">
              <button
                click.trigger="playAudio(file, $parent.$index, $index)">
                Attachment ${$index}
              </button>
              <audio id="js-audio-${$parent.$index}-${$index}"></audio>
            </div>
          </div>
        </div>
        <div class="col actions right">
          <button if.bind="dataStore.isJournalist"
            click.trigger="editArticle(article._id)">
            Edit Article
          </button>
          <button if.bind="dataStore.isJournalist"
            click.trigger="removeArticle(article)">
            Remove Article
          </button>
          <button if.bind="dataStore.isAdmin"
            click.trigger="activateArticle(article._id)">
            Activate Article
          </button>
          <button if.bind="dataStore.isVoiceOver"
            click.trigger="addToCart(article)">
            Add audio
          </button>
          <button if.bind="dataStore.isUser && !article.selected"
            click.trigger="addToCart(article)">
            Add to cart
          </button>
          <button if.bind="dataStore.isUser && article.selected"
            click.trigger="removeFromCart(article)">
            Remove from cart
          </button>
        </div>
      </div>
    </div>
  </div>
</template>
